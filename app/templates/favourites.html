{% extends 'base.html' %}

{% block title %} <title>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</title> {% endblock %}

{% block content %}

<script>
    window.onload = setTimeout(function () {
        showNotification("–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ üíú, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –æ—Ç—Å—é–¥–∞ –ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç");
        setTimeout(function () {
            hideNotification();
        }, 10000);
    }, 100);
</script>

<main>
    <h1>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h1>
</main>
<div class="types favtypes">
    <div class="catalog favcatalog">

        {% if not favourites %}

            <h2>–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç :( –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ —á—Ç–æ-–Ω–∏–±—É–¥—å, –Ω–∞–∂–∞–≤ –Ω–∞ üíú</h2>

        {% else %}

            <script src="//ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
            <script type=text/javascript>
                function removeFromFav(id) {
                    $.ajax({
                        url: '/favourites/remove',
                        type: 'POST',
                        data: id,
                        contentType: 'application/json;charset=UTF-8',
                        success: function () {
                            setTimeout(function () {
                                showNotification("–ü—Ä–µ–¥–º–µ—Ç —É–±—Ä–∞–Ω –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ üëå");
                                setTimeout(function () {
                                    hideNotification();
                                }, 4000);
                            }, 100);
                            document.getElementById('item' + id).style.display = 'none';
                            document.getElementById("count").innerHTML -= 1
                        },
                        error: function (err) {
                            setTimeout(function () {
                                showNotification("–ù–µ —É–¥–∞–ª–æ—Å—å —É–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ üôà");
                                setTimeout(function () {
                                    hideNotification();
                                }, 4000);
                            }, 100);
                            console.log(err);
                        }
                    });
                };
            </script>

            <h2>
                <h id="count" style="display: inline;">{{ favs_len }}</h>
                —à—Ç. –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º üí´
            </h2>
            <div class="favgallery">
                
            {% for item in favourites %}

                <div class="card" id="item{{ item.id }}">
                    <a href="product?id={{ item.id }}">
                        <img src="/static/img/items/{{ item.images.0 }}" alt="">
                    </a>
                    <div>
                        <a href="product?id={{ item.id }}">
                            <h4>{{ item.title }}</h4>
                        </a>
                        <span class="stars">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <img src="static/img/gui/star.svg" alt="">
                        <p>4.8</p>
                    </span>
                        <span>
                        <div class="price">
                            <p>{{ item.price }} &#8381;</p>
                        </div>
                        <div class="icons">
                            <!-- TODO: –î–æ–±–∞–≤–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –æ—Ç—Å—é–¥–∞ -->
                            <a> <img src="static/img/gui/telega_small.svg" alt=""> </a>
                            <button value="{{ item.id }}" onclick="removeFromFav(this.value)"><img
                                    src="static/img/gui/favourite_small.svg" alt=""> </button>
                        </div>
                    </span>
                    </div>
                </div>

            {% endfor %}

        {% endif %}

        </div>
    </div>
<div class="notification">
    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–∫–Ω–∞ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
</div>

{% endblock %}